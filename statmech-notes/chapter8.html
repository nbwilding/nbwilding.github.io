<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>chapter8 – Statistical Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2c42b87c12db89318abc72421661ad2d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html">Chapters</a></li><li class="breadcrumb-item"><a href="./chapter8.html">8. Einstein’s model of a simple solid</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./NotesFigs/courselogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./course-texts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course texts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Foundations: equilibrium of an isolated system</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Entropy, equilibrium, and the second Law</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. The Boltzmann distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Free energy minimisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Systems of weakly interacting constituents</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. More on magnetism; review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">8. Einstein’s model of a simple solid</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Ideal gas and indistinguishability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Ideal gas in the low density limit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Systems with varying particle number</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Quantum gases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Ideal Fermi gas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Problems</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Problem_set_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 20: Problem set 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Problem_set_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 21: Problem set 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Problem_set_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 22: Problem set 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Problem_set_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 23: Problem set 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Solutions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions_set_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 20: Solutions set 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions_set_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 21: Solutions set 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions_set_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 22: Solutions set 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions_set_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 23: Solutions set 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Lecture slides by chapter as PDF</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter1.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter2.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter3.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter4.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter5.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter6.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter7.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter9.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 9</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter10.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter11.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter12.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 12</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture slides/chapter13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides chapter 13</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Course notes by chapter as PDF</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter1.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter2.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter3.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter4.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter5.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter6.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter7.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter9.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 9</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter10.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter11.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter12.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 12</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PDFs/chapter13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">chapter 13</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Coursework preparation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Coursework/assignment_prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coursework assignment preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Coursework/coursework_intro_slides.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coursework introduction slides</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#einsteins-model-of-a-simple-solid" id="toc-einsteins-model-of-a-simple-solid" class="nav-link active" data-scroll-target="#einsteins-model-of-a-simple-solid">8 Einstein’s model of a simple solid</a>
  <ul class="collapse">
  <li><a href="#simple-model-of-a-solid" id="toc-simple-model-of-a-solid" class="nav-link" data-scroll-target="#simple-model-of-a-solid">8.1 Simple model of a solid</a></li>
  <li><a href="#statistical-mechanics-of-the-quantum-harmonic-oscillator" id="toc-statistical-mechanics-of-the-quantum-harmonic-oscillator" class="nav-link" data-scroll-target="#statistical-mechanics-of-the-quantum-harmonic-oscillator">8.2 Statistical mechanics of the quantum harmonic oscillator</a></li>
  <li><a href="#thermodynamic-properties" id="toc-thermodynamic-properties" class="nav-link" data-scroll-target="#thermodynamic-properties">8.3 Thermodynamic properties</a></li>
  <li><a href="#high-and-low-temperature-behaviour" id="toc-high-and-low-temperature-behaviour" class="nav-link" data-scroll-target="#high-and-low-temperature-behaviour">8.4 High and low temperature behaviour</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter1.html">Chapters</a></li><li class="breadcrumb-item"><a href="./chapter8.html">8. Einstein’s model of a simple solid</a></li></ol></nav></header>




<section id="einsteins-model-of-a-simple-solid" class="level1">
<h1>8 Einstein’s model of a simple solid</h1>
<p>Here we apply the Boltzmann distribution to the vibrational energy of atoms in a solid. In so doing we use a fundamental model of quantum physics—the quantum harmonic oscillator.</p>
<section id="simple-model-of-a-solid" class="level2">
<h2 class="anchored" data-anchor-id="simple-model-of-a-solid">8.1 Simple model of a solid</h2>
<p><em>See Mandl 6.2</em></p>
<p>Recall from your first year Properties of Matter course that in a crystalline solid, atoms sit on the sites of a regular array (lattice). A model for the vibrational motion of the atoms about their equilibrium positions (lattice sites) is to consider the atoms attached to each other by springs (see <a href="#fig-einstein-a" class="quarto-xref">Figure&nbsp;1 (a)</a>). However this a (strongly) interacting system since energy is stored in interaction potentials (the springs) between atoms.</p>
<div id="fig-einsteinsolid" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-einsteinsolid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-einsteinsolid" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-einstein-a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-einstein-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="NotesFigs/Einstein_solid.png" class="img-fluid figure-img" data-ref-parent="fig-einsteinsolid">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-einstein-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Model of crystal solid as atoms connect by harmonic springs.
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-einsteinsolid" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-einstein-b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-einstein-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="NotesFigs/Einstein_single_particle.png" class="img-fluid figure-img" data-ref-parent="fig-einsteinsolid">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-einstein-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Model of each atom as independent harmonic oscillator
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-einsteinsolid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>We seek a weakly interacting system that models the behaviour. A simple approximation is illustrated in <a href="#fig-einstein-b" class="quarto-xref">Figure&nbsp;1 (b)</a>. Each atom sits in its own harmonic potential and the motion of atoms independent of the others. This is the Einstein model.</p>
<p>Let us first consider the system classically. Each oscillator has energy</p>
<p><span class="math display">\[
\varepsilon = \frac{1}{2} \kappa x^2 + \frac{1}{2} mv^2
\]</span></p>
<p>where <span class="math inline">\(x\)</span> is the displacement from equilibrium position. Thus in 3d the system has <span class="math inline">\(N \times 3 \times 2\)</span> quadratic contributions (<span class="math inline">\(N\)</span> particles, <span class="math inline">\(3\)</span> dimensions, P.E. + K.E.) to the energy. The equipartition theorem then implies that the energy and heat capacity of the system should be</p>
<p><span class="math display">\[
\overline{E} = 6N \times \frac{1}{2} kT = 3NkT
\]</span></p>
<p><span class="math display">\[
C_V = \frac{\partial \overline{E}}{\partial T} = 3Nk
\]</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
More on the Equipartition Theorem
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>For each degree of freedom of a system with an energy which is quadratic in either the coordinate or the momentum, the average energy is <span class="math inline">\(kT/2\)</span> and its contribution to the heat capacity is <span class="math inline">\(k/2\)</span>, at high enough temperatures.</strong></p>
<p>The equipartition theorem is applicable only when the system can be described classically and is applicable only to each term in the energy that is proportional to a coordinate squared. This coordinate must take on a continuum of values from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span>. Here are some examples from classical mechanical systems.</p>
<ul>
<li><p><strong>Vibrations:</strong> <span class="math display">\[
E_{vib} = \frac{1}{2} m\dot{x}^2 + \frac{1}{2} \kappa x^2
\]</span> Two quadratic degrees of freedom, hence <span class="math inline">\(E \rightarrow kT\)</span> as <span class="math inline">\(T \to \infty\)</span>. Note that here <span class="math inline">\(\kappa\)</span> is the spring constant.</p></li>
<li><p><strong>Rotations:</strong> Two perpendicular axes about which a molecule can rotate, <span class="math display">\[
E_{rot} = \frac{1}{2} I_1 \dot{\theta}_1^2 + \frac{1}{2} I_2 \dot{\theta}_2^2
\]</span> Two quadratic degrees of freedom, hence <span class="math inline">\(E \rightarrow kT\)</span> as <span class="math inline">\(T \to \infty\)</span>.</p></li>
<li><p><strong>Translations:</strong> <span class="math display">\[
E_{tr} = \frac{1}{2} m(\dot{x}^2 + \dot{y}^2 + \dot{z}^2)
\]</span> Three quadratic degrees of freedom, hence <span class="math inline">\(E\rightarrow \frac{3}{2}kT\)</span> as <span class="math inline">\(T \to \infty\)</span>.</p></li>
</ul>
<p>The equipartition theorem is a fundamental principle in classical physics. However, from the perspective of modern statistical mechanics, it fails when the energy level separation is significantly larger than thermal energy. In such cases, the heat capacity associated with that degree of freedom decreases, eventually approaching zero at low temperatures. This phenomenon is referred to as “freezing out” of the degree of freedom. A common example is the vibrational degrees of freedom, which are typically frozen out at room temperature.</p>
<p>More specifically, equipartition holds:</p>
<ul>
<li>for <strong>vibrations</strong>, when <span class="math inline">\(T \gg \hbar \omega / k \approx 10^3 K\)</span>;</li>
<li>for <strong>rotations</strong>, when <span class="math inline">\(T \gg \hbar^2 / I k \approx 10 - 100 K\)</span>;</li>
<li>for <strong>translations</strong>, when <span class="math inline">\(T \gg \hbar^2 / (m V^{2/3} k) \approx 10^{-14} K\)</span>.</li>
</ul>
<p>Thus, at room temperature, only the rotational and translational degrees of freedom can be treated classically, giving <span class="math inline">\(C_V = \frac{3}{2} R\)</span> for monatomic gases and <span class="math inline">\(C_V = \frac{5}{2} R\)</span> for diatomic gases, for the molar heat capacity.</p>
<p>Using the equipartition theorem, we can estimate the heat capacities of various substances by counting their quadratic degrees of freedom. For example, in a solid, each atom can vibrate in three directions, leading to an expected molar heat capacity of (3R). This prediction aligns with the <strong>Dulong-Petit law</strong>, which accurately describes the heat capacities of many solids at room temperature.</p>
</div>
</div>
</div>
<p>If you have forgotten the equipartition theorem, you can find it in your first year Properties of Matter notes and in the note above. However we will understand it at a deeper level in a few chapters’ time.</p>
<p>The prediction for the heat capacity was well borne out experimentally for many monoatomic solids and is known as the Dulong–Petit law. However diamond has a smaller heat capacity than the Dulong–Petit law predicts. Einstein showed that this is a quantum effect.</p>
<p>To understand why at a qualitative level quantum effects are important in diamond. Recall that diamond is very hard. This means that the ‘spring constant’ of the classical oscillator modelling each atom in Figure 1 is very large. Therefore the frequency of the oscillators is very large and and the typical displacements very small. This last fact implies that quantum effects have to be taken into account– roughly speaking, from the uncertainty principle if the displacements are very small then we know the atoms’ positions with high accuracy, therefore there must be uncertainty in the momenta (velocities).</p>
</section>
<section id="statistical-mechanics-of-the-quantum-harmonic-oscillator" class="level2">
<h2 class="anchored" data-anchor-id="statistical-mechanics-of-the-quantum-harmonic-oscillator">8.2 Statistical mechanics of the quantum harmonic oscillator</h2>
<p>From quantum mechanics recall that a one dimensional harmonic oscillator has energy levels</p>
<p><span class="math display">\[
\varepsilon = \left(n + \frac{1}{2}\right)\hbar\omega
\]</span></p>
<p>where the quantum number <span class="math inline">\(n = 0, 1, 2 \ldots\)</span> (see chapter 8 of quantum mechanics notes). The ground state energy <span class="math inline">\(n = 0\)</span> is <span class="math inline">\(\frac{1}{2}\hbar\omega\)</span>. The generalisation to a three-dimensional oscillator is easy</p>
<p><span class="math display">\[
\varepsilon_{3d} = \left(n_x + n_y + n_z + \frac{3}{2}\right)\hbar\omega
\]</span></p>
<p>Einstein’s model is a system of <span class="math inline">\(N\)</span> 3d quantum oscillators all with the same frequency <span class="math inline">\(\omega\)</span> in thermal equilibrium; <span class="math inline">\(\omega\)</span> is chosen to fit the experimental data.</p>
<p>From the statistical mechanics of weakly interacting systems we have <span class="math inline">\(Z = [Z(1)]^N\)</span>. Now since the energy of an oscillator is a sum of three similar contributions we will have a further factorisation (see chapter 6.3) and</p>
<p><span class="math display">\[
Z = [Z(1)]^N = \left[Z_{1d}(1)\right]^{3N}
\]</span></p>
<p>where <span class="math inline">\(Z_{1d}(1)\)</span> is the partition function for a single 1d oscillator. The task reduces to the calculation of <span class="math inline">\(Z_{1d}(1)\)</span></p>
<p><span class="math display">\[
Z_{1d}(1) = \sum_{n=0}^{\infty} \exp\left(-\beta\hbar\omega\left[n + \frac{1}{2}\right]\right)
\]</span></p>
<p>To evaluate the sum recall the geometric series, valid for <span class="math inline">\(|a|&lt;1\)</span></p>
<p><span class="math display">\[
\sum_{n=0}^{\infty} a^n = \frac{1}{1 - a}
\]</span></p>
<p>Thus, inserting <span class="math inline">\(a=\exp(-\beta\hbar\omega)\)</span>, we find</p>
<p><span class="math display">\[
Z_{1d}(1) = \frac{\exp\left(-\frac{x}{2}\right)}{1 - \exp(-x)}
\]</span></p>
<p>where <span class="math inline">\(x = \beta\hbar\omega\)</span>.</p>
</section>
<section id="thermodynamic-properties" class="level2">
<h2 class="anchored" data-anchor-id="thermodynamic-properties">8.3 Thermodynamic properties</h2>
<p>We now turn the handle to crank out the thermodynamics variables. First note</p>
<p><span class="math display">\[
\overline{E} = 3N\overline{\varepsilon} = 3N\hbar\omega\left(\overline{n} + \frac{1}{2}\right)
\]</span></p>
<p>It is easiest to calculate <span class="math inline">\(\varepsilon\)</span> directly from the relation</p>
<p><span class="math display">\[
\overline{\varepsilon} = -\frac{\partial}{\partial\beta} \ln Z_{1d}(1) = -\frac{dx}{d\beta} \frac{\partial}{\partial x} \ln Z_{1d}(1)
\]</span></p>
<p><span class="math display">\[
= -\hbar\omega \frac{\partial}{\partial x} \left[-\ln\left(1 - \exp(-x)\right) - \frac{x}{2}\right]
\]</span></p>
<p><span class="math display">\[
= \hbar\omega \left[\frac{\exp(-x)}{1 - \exp(-x)} + \frac{1}{2}\right]
\]</span></p>
<p>and we see that the average quantum number is</p>
<p><span class="math display">\[
\overline{n} = \frac{\exp(-x)}{1 - \exp(-x)} = \frac{1}{\exp(x) - 1}
\]</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand to see an alternative derivation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Aside: An alternative derivation is to use the Boltzmann distribution <span class="math inline">\(P_n\)</span> for the levels <span class="math inline">\(n\)</span> of a 1d oscillator explicitly</p>
<p><span class="math display">\[
\overline{n} = \sum_{n=0}^{\infty} P_n n = \frac{1}{Z_{1d}(1)} \sum_{n=0}^{\infty} n \exp\left[-x\left(n + \frac{1}{2}\right)\right]
\]</span></p>
<p>then use the identity</p>
<p><span class="math display">\[
\sum_{n=0}^{\infty} n a^n = a \frac{d}{da} \sum_{n=0}^{\infty} a^n = a \frac{d}{da} \frac{1}{1 - a} = \frac{a}{(1 - a)^2}
\]</span></p>
</div>
</div>
</div>
<p>The mean total energy is given by</p>
<p><span class="math display">\[
\overline{E} = 3N\hbar\omega \left[\frac{\exp(-x)}{1 - \exp(-x)} + \frac{1}{2}\right]
\]</span></p>
<p>and the heat capacity is given by</p>
<p><span class="math display">\[
C_V = \left(\frac{\partial \overline{E}}{\partial T}\right)_V = \left(\frac{\partial x}{\partial T}\right)_\omega \left(\frac{\partial \overline{E}}{\partial x}\right)_\omega
\]</span></p>
<p>Note that here the ‘constant volume’ constraint on the partial derivative is the same as the ‘constant <span class="math inline">\(\omega\)</span>’ constraint. This is because the only way volume (or any other variable except temperature) can enter into the model is through the parameter <span class="math inline">\(\omega\)</span>.</p>
<p>We find</p>
<p><span class="math display">\[
C_V = -3N \frac{\hbar\omega}{k T^2} \frac{d}{dx} \left[\frac{1}{\exp(x) - 1}\right] = 3Nk \frac{x^2 \exp(x)}{(\exp(x) - 1)^2}
\]</span></p>
</section>
<section id="high-and-low-temperature-behaviour" class="level2">
<h2 class="anchored" data-anchor-id="high-and-low-temperature-behaviour">8.4 High and low temperature behaviour</h2>
<p>To define the high temperature and low temperature regimes we define a characteristic temperature <span class="math inline">\(T^*\)</span> defined by <span class="math inline">\(x = 1\)</span> i.e.&nbsp;when <span class="math inline">\(kT\)</span> equals the excitation energy <span class="math inline">\(\hbar\omega\)</span>. Below this temperature quantum effects with typical energy <span class="math inline">\(\sim\hbar\omega\)</span> dominate over classical effects with typical energy <span class="math inline">\(\sim kT\)</span>.￼</p>
<p><span class="math display">\[
T^* = \frac{\hbar\omega}{k}
\]</span></p>
<p>Thus in the high temperature regime <span class="math inline">\(T \gg T^\star\)</span> (<span class="math inline">\(x \ll 1\)</span>) we find</p>
<p><span class="math display">\[
\overline{n} \approx \frac{1}{1 + x \ldots - 1} \approx \frac{1}{x} = \frac{kT}{\hbar\omega}
\]</span></p>
<p><span class="math display">\[
\overline{E} \approx 3NkT + \frac{3}{2}N\hbar\omega
\]</span></p>
<p>we see that <span class="math inline">\(\overline{n}\)</span> and hence <span class="math inline">\(\overline{\varepsilon}\)</span> and <span class="math inline">\(\overline{E}\)</span> increase linearly with temperature. Moreover the heat capacity becomes</p>
<p><span class="math display">\[
C_V = \left(\frac{\partial \overline{E}}{\partial T}\right)_V \approx 3Nk
\]</span></p>
<p>and we recover the Dulong–Petit law.</p>
<p>In the low temperature regime <span class="math inline">\(T \ll T^\star\)</span> (<span class="math inline">\(x \gg 1\)</span>) we have</p>
<p><span class="math display">\[
\overline{n} \approx \exp(-x)
\]</span></p>
<p><span class="math display">\[
\frac{C_V}{3Nk} \approx x^2 \exp(-x)
\]</span></p>
<p>The mean energy level <span class="math inline">\(\overline{n}\)</span> tends to zero meaning most oscillators are in the ground state; the heat capacity is very much less than <span class="math inline">\(3Nk\)</span>.</p>
<p>Thus when <span class="math inline">\(x = \frac{\hbar\omega}{kT}\)</span> is large, quantum effects, in particular the effect of a discrete gap between the ground state and first excited state, become important. The Einstein model quite successfully explained the experimentally observed heat capacity of diamond (see Mandl 6.2). However the very low temperature behaviour of the heat capacity was still not quite right. In fact a <span class="math inline">\(T^3\)</span> dependence appeared to emerge. This can be explained by an elaborated version of the Einstein theory known as the Debye theory. In essence the central weakness of the Einstein model is its neglect of collective motion of atoms (so called phonons) which exhibit a spectrum of frequencies.</p>
<p>When <span class="math inline">\(x = \frac{\hbar\omega}{kT}\)</span> is small we recover the ‘classical’ results i.e.&nbsp;results where Planck’s constant does not appear in the thermodynamic quantities (except as an arbitrary constant in the energy). Quite generally high temperature is the classical limit (if indeed one exists).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>